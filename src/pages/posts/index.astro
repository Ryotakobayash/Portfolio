---
export const prerender = true;
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import PostSearch from '../../components/PostSearch';

const posts = await getCollection('posts');
const sortedPosts = posts
  .map((post) => ({
    slug: post.id.replace(/\.mdx?$/, ''),
    title: post.data.title,
    date: post.data.date,
    excerpt: post.data.excerpt || '',
    tags: post.data.tags || [],
  }))
  .sort((a, b) => (a.date < b.date ? 1 : -1));
---

<BaseLayout title="記事一覧 | Dashboard Portfolio">
  <div class="page-header">
    <h1 class="page-title">記事一覧</h1>
    <p class="page-description">{sortedPosts.length} 件の記事</p>
  </div>

  <!-- 検索機能付き記事リスト -->
  <PostSearch client:load posts={sortedPosts} />
</BaseLayout>

<style>
  .page-header {
    margin-bottom: var(--spacing-xl);
  }

  .page-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: var(--spacing-sm);
  }

  .page-description {
    color: var(--color-text-muted);
  }
</style>
